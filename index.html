<html>
<head>
<style>
/* MAIN STYLES*/
body
{
    margin: 0;
    width: 100vw;
    height: 100vh;
    background-color: black;
    overflow: hidden;
    transition: transform 0.1s ease-in-out;
}
#main
{
    width: 100vw;
    height: 56.25vw;
    background-image: url(img/main.png);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
}

/* HARD MODE TOGGLE BUTTONS */
#hardModeButton
{
    background-repeat: no-repeat;
    width: 20.2vw;
    height: 3.8vw;
    position: absolute;
    top: 47.05vw;
    left: 71vw;
    cursor: url(img/cursor.png) 10 2,pointer;
    background-size: 100% 100%;

}
.hardOn
{
    background-image: url(img/hard_mode_on.png);
}
.hardOff
{
    background-image: url(img/hard_mode_off.png);

}
/* PRIMARY LOOT SELECTOR */
#lootFrame
{
    z-index: 2;
    top: 32vw;
    left: 6.75vw;
    width: 27.35vw;
    height: 14.7vw;
    background-image: url(img/loot_frame.png);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
    cursor: url(img/cursor.png) 10 2,pointer;
    overflow: hidden;
}
#lootPic
{
    z-index: 0;
    top: 32.1vw;
    left: 7.1vw;
    width: 26.75vw;
    height: 14.5vw;
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
}
#lootName
{
    top: 46.7vw;
    left: 7vw;
    width: 26.7vw;
    height: 3.5vw;
    text-align: center;
    display: block;
    color: transparent;
    text-shadow: 0 0 0.1vw rgb(228 89 88);
    font-size: 1.8vw;
    position: absolute;
    line-height: 200%;
    user-select: none;
}
#lootSelector
{
    top: 10%;
    left: 3.5%;
    width: 95%;
    height: 95%;
    position: absolute;
    overflow: visible;
    margin: 0;
    padding: 0;
}
#lootSelector:hover .lootObject
{
    z-index: 0;
    width: 15%;
    transition: width 0.05s linear, background-size 0.05s linear;
}
#lootSelector:hover .lootObject:last-child
{
    z-index: 1 !important;
    width: 65% !important;
    transform: perspective(0) rotateY(0deg);
}
.lootDefault { background-image: url(img/primary_loot/default.gif); }
.lootTequilla { background-image: url(img/primary_loot/tequilla.png); }
.lootNecklace { background-image: url(img/primary_loot/necklace.png); }
.lootBonds { background-image: url(img/primary_loot/bonds.png); }
.lootDiamond { background-image: url(img/primary_loot/diamond.png); }
.lootPanther { background-image: url(img/primary_loot/panther.png); }
.lootFiles { background-image: url(img/primary_loot/files.png); }
.lootObject
{
    z-index: 0;
    transform: perspective(500px) rotateY(35deg);
    width: 24%;
    height: 81%;
    background-repeat: no-repeat;
    background-position: 40% 50%;
    background-size: 200% 200%;
    border: 0.55vw solid #f0eeef9c;
    border-radius: 2px;
    display: inline-block;
    margin-right: -15%;
    cursor: url(img/cursor.png) 10 2,pointer;
    margin-bottom: 3%;
}
.lootObject:hover
{
    z-index: 1 !important;
    border-color: #f0ec809c !important;
    width: 65% !important;
    background-size: 100% 100%;
    /* height: 65%; */
    transform: perspective(0) rotateY(0deg);
}

/*  GENERAL HIDDEN CLASS */
.hidden
{
    display: none;
}

/* PRIMARY VALUE */
#moneyLimits
{
    background-image: url(img/prices_frames.png);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
    width: 14.9vw;
    height: 17.9vw;
    top: 4.7vw;
    right: 7.7vw;
}
#primaryName
{
    position: absolute;
    width: 14.7vw;
    height: 2.3vw;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 0.1vw #411c1be6;
    font-size: 1.4vw;
    line-height: 1.9vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
}
#primaryValue
{
    position: absolute;
    width: 14.7vw;
    height: 2.8vw;
    top: 2.1vw;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 0.1vw #ffffffab;
    font-size: 1.4vw;
    line-height: 2.5vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
}

/* HEIST SETUP OPTIONS */
#setupContainer
{
    position: absolute;
    width: 26.5vw;
    height: 25.3vw;
    top: 5.6vw;
    left: 7.5vw;
    border: 0px solid #ffffffab;
}
.setupCategory
{
    height: 3vw;
    background-image: url(img/element.png);
    background-size: 100% 110%;
    padding-left: 0.5vw;
    cursor: url(img/cursor.png) 10 2,pointer;
    color: transparent;
    text-shadow: 0 0 0.1vw #ffffffab;
    padding-top: 0px;
    margin-bottom: 0.3vw;
    position: relative;
}
.setupCategory:hover
{
    background-color: #ffffffab;
    text-shadow: 0 0 0.1vw #000;
    transition: background-color 0.5s linear;
}
.setupCategory span
{
    color: inherit;
    text-shadow: inherit;
    padding-left: 1.8vw;
    font-size: 1.5vw;
    line-height: 3vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
    pointer-events: none;
}
.backButton
{
    cursor: url(img/cursor.png) 10 2,pointer;
    color: transparent;
    text-shadow: 0 0 0.1vw #ffffffab;
    height: 3vw;
    font-size: 1.5vw;
    line-height: 3vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
}
.checkbox
{
    width: 6%;
    height: 60%;
    position: absolute;
    top: 20%;
    display: inline-flex;
    margin: 0;
    line-height: 4vh;
    pointer-events: none;
}
.checked
{
    background-image: url(img/checked.png);
    background-size: 100% 100%;
}
.teamSize
{
    text-align: center;
}
.playerCut, .teamSize
{
    background-color: transparent;
    outline: none;
    border: 0px;
    color: #827d7d;
    font-size: 1.4vw;
    width: 4vw;
    right: 5%;
    position: absolute;
    top: 0.8vw;
    border-radius: 25%;
}
.setupCategory:hover .playerCut, .setupCategory:hover .teamSize
{
    color: black;
}

/* CUSTOM MONEY LIMIT CLASSES */
.moneyLimitLabel
{
    position: absolute;
    width: 14.7vw;
    height: 2.3vw;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 0.1vw #411c1be6;
    font-size: 1.4vw;
    line-height: 1.9vw;
    font-variant: all-small-caps;
    font-family: system-ui;
}
.moneyLimit
{
    position: absolute;
    width: 14.7vw;
    height: 2.8vw;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 1.5px #f0eeef9c;
    font-size: 1.4vw;
    line-height: 3.4vh;
    font-variant: all-small-caps;
    font-family: system-ui;
    background-color: transparent;
    border: 0px;
    outline: none;
    caret-color: #f0eeef9c;
}
#cutLimitLabel
{
    top: 12.9vw;
    user-select: none;
}
#cutLimit
{
    top: 14.9vw;
}
#takeLimitLabel
{
    top: 6.4vw;
    user-select: none;
}
#takeLimit
{
    top: 8.5vw;
}
.error
{
    animation: errorFont 1s infinite;
}
@keyframes errorFont
{
  0% { text-shadow: 0 0 1.5px #f0eeef9c; }
  50% { text-shadow: 0 0 1.5px #411c1be6; }
  100% { text-shadow: 0 0 1.5px #f0eeef9c; }
}

/* TRUCK LOCATION SELECTOR */
.truckIcon
{
    background-image: url(img/truck_off.png);
    background-size: 100% 100%;
    width: 1.4vw;
    height: 1.7vw;
    position: absolute;
    cursor: url(img/cursor.png) 10 2,pointer;
}
.truckOn
{
    background-image: url(img/truck_on.png);
}
#truck1
{
    top: 11vw;
    left: 56.4vw;
}
#truck2
{
    top: 13.2vw;
    left: 71vw;
}
#truck3
{
    top: 24.6vw;
    left: 71.5vw;
}
#truck4
{
    top: 26.6vw;
    left: 66.3vw;
}
#truck5
{
    top: 38.6vw;
    left: 66.5vw;
}

/* GRAPPLING HOOK LOCATION SELECTOR*/
.hookIcon
{
    background-image: url(img/grappling_hook_off.png);
    background-size: 100% 100%;
    width: 1.7vw;
    height: 1.7vw;
    position: absolute;
    cursor: url(img/cursor.png) 10 2,pointer;
}
.hookOn
{
    background-image: url(img/grappling_hook_on.png);
}
#hook1
{
    top: 15.9vw;
    left: 55.4vw;
}
#hook2
{
    top: 13.2vw;
    left: 68.9vw;
}
#hook3
{
    top: 26.5vw;
    left: 70vw;
}
#hook4
{
    top: 26.5vw;
    left: 80.5vw;
}

/* OUTFITS LOCATION SELECTOR */
.clothesIcon
{
    background-image: url(img/clothes_off.png);
    background-size: 100% 100%;
    width: 1.7vw;
    height: 1.7vw;
    position: absolute;
    cursor: url(img/cursor.png) 10 2,pointer;
}
.clothesOn
{
    background-image: url(img/clothes_on.png);
}
#clothes1
{
    top: 12.3vw;
    left: 54.4vw;
}
#clothes2
{
    top: 11.4vw;
    left: 69.9vw;
}
#clothes3
{
    top: 29vw;
    left: 65.7vw;
}
#clothes4
{
    top: 32.8vw;
    left: 64.5vw;
}

/* CUTTERS LOCATION SELECTOR */
.cuttersIcon
{
    background-image: url(img/bolt_cutters_off.png);
    background-size: 100% 100%;
    width: 1.7vw;
    height: 1.7vw;
    position: absolute;
    cursor: url(img/cursor.png) 10 2,pointer;
}
.cuttersOn
{
    background-image: url(img/bolt_cutters_on.png);
}
#cutters1
{
    top: 13.3vw;
    left: 56.4vw;
}
#cutters2
{
    top: 15.1vw;
    left: 71.2vw;
}
#cutters3
{
    top: 24.4vw;
    left: 66.7vw;
}
#cutters4
{
    top: 32.5vw;
    left: 75.7vw;
}

/* PLAYER MONEY DISPLAY */
#playerCutContainer
{
    background-image: url(img/player_cuts.png);
    background-size: 100% 100%;
    width: 23vw;
    height: 10vw;
    position: absolute;
    top: 38vw;
    left: 36vw;
}
#totalCut
{
    position: absolute;
    top: 10vw;
    right: 2vw;
    color: transparent;
    text-shadow: 0 0 1.5px #f0eeef9c;
    font-size: 1.5vw;
    line-height: 2.8vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
}
.playerMoney
{
    color: transparent;
    text-shadow: 0 0 0.1vw #ffffffab;
    padding-left: 1.8vw;
    font-size: 1.5vw;
    line-height: 2.4vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
    pointer-events: none;
    position: relative;
}
.playerMoney span:last-child
{
    right: 2vw;
    position: absolute;
    top: 0.2vw;
}

/* STAT.TXT EXPORT BUTTONS */
#stattextContainer
{
    top: 4vw;
    left: 36.4vw;
    position: absolute;
    user-select: none;
}
#stattextContainer div
{
    display: inline-block;
    color: transparent;
    text-shadow: 0 0 0.1vw #e45958ab;
    padding-left: 1.8vw;
    font-size: 1.5vw;
    line-height: 2vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    text-align: center;
    padding: 0 0vw 0.25vw 1vw;
}
.statTextButton
{
    border: 0.2vw solid #8e3232;
    border-radius: 0.2vw;
    cursor: url(img/cursor.png) 10 2,pointer;
    background-color: #1e1516c2;
}
.statTextButton:after
{
    top: -0.9vw;
    right: -0.1vw;
    position: relative;
    content: "✔";
    pointer-events: none;
    opacity: 0;
    font-size: 1.5vw;
}
.appear:after
{
    opacity: 1;
}
.fadeOut:after
{
    transition: opacity 3s ease-in;
}

/* STAT.TXT TEXTAREA FOR COPY OPTION */
.invisibleTextarea
{
    position: fixed;
    top: 0;
    left: 0;
    width: 2em;
    height: 2em;
    zIndex: -1;
}

/* STAT.TXT SOURCE VIEWER */
.statTextViewer
{
    position: absolute;
    top: 2.5vw;
    left: 25vw;
    width: 50vw;
    height: 50vw;
    background-color: black;
    color: #f0eeef9c;
    white-space: pre-wrap;
    z-index: 3;
    border: 0.3vw solid #aa4241bd;
    overflow-y: scroll;
    padding: 2vw;
    line-height: 1.5vw;
    font-size: 1vw;
}
.textViewOverlay
{
    background-color: #00000077;
    z-index: 2;
    position: absolute;
    width: 100vw;
    height: 100vh;
    cursor: url(img/cursor.png) 10 2,pointer;
}

/* EL RUBIO SAFE EXCLUSION CHECKBOX */
#elRubioSafe
{
    position: absolute;
    font-size: 1.5vw;
    top: 12.9vw;
    color: transparent;
    text-shadow: 0 0 0.1vw #411c1be6;
    padding-left: 1vw;
    right: 1.1vw;
    cursor: url(img/cursor.png) 10 2,pointer;
    user-select: none;
}

/* COMPOUND LAYER */
#compoundSettings
{
    position: absolute;
    top: 3.6vw;
    left: 34.9vw;
    width: 58.4vw;
    height: 47.3vw;
    transition: clip-path 0.5s linear;
}

/* COMPOUND MAP CLIPPING */
.compoundExpanded
{
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
}
.compoundContracted
{
    clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
}
.compoundHidden
{
    clip-path: polygon(0 100%, 100% 100%, 100% 100%, 0 100%);
}
#compoundMap
{
    width: inherit;
    height: inherit;
    position: absolute;
    background-image: url(img/compound_map.png);
    background-size: 100% 100%;
}

/* GENERAL LOOT SPOT ICON*/
.lootSpot
{
    border: 0.2vw solid #8c3d40;
    border-radius: 50%;
    width: 1.5vw;
    height: 1.5vw;
    display: block;
    position: absolute;
    font-size: 1.2vw;
    line-height: 1.5vw;
    color: transparent;
    text-shadow: 0 0 0.1vw #8c3d40;
    text-align: center;
    background-color: #1a1414de;
    cursor: url(img/cursor.png) 10 2,pointer;
    user-select: none;
}
.lootSpot:before
{
    top: 0.1vw;
    position: relative;
}

/* ISLAND SECONDARY LOOT LOCATIONS */
#hangarTopA
{
    top: 7vw;
    left: 56vw;
}
#hangarTopB
{
    top: 9vw;
    left: 56vw;
}
#hangarLowA
{
    top: 9.5vw;
    left: 51.6vw;
}
#hangarLowB
{
    top: 9.5vw;
    left: 53.7vw;
}
#airstripA
{
    top: 12.3vw;
    left: 58vw;;
}
#airstripB
{
    top: 12.3vw;
    left: 60vw;
}
#northDockLongShedA
{
    top: 11.1vw;
    left: 65.6vw;
}
#northDockLongShedB
{
    top: 11.1vw;
    left: 67.7vw;
}
#northDockLockedShedA
{
    top: 15.5vw;
    left: 68.8vw;
}
#northDockLockedShedB
{
    top: 17.3vw;
    left: 67.5vw;
}
#northDockLockedShedC
{
    top: 17.5vw;
    left: 69.6vw;
}
#northDockShedA
{
    top: 11.3vw;
    left: 71.9vw;
}
#northDockShedB
{
    top: 11.3vw;
    left: 74.1vw;
}
#weedFarmA
{
    top: 29.3vw;
    left: 76.1vw;
}
#weedFarmB
{
    top: 27.7vw;
    left: 74.7vw;
}
#centralShedA
{
    top: 26.6vw;
    left: 72vw;
}
#centralShedB
{
    top: 28.7vw;
    left: 72vw;
}
#mainDockEastShedA
{
    top: 26.4vw;
    left: 68vw;
}
#mainDockEastShedB
{
    top: 28.5vw;
    left: 68vw;
}
#mainDockLargeShedA
{
    top: 24vw;
    left: 64.7vw;
}
#mainDockLargeShedB
{
    top: 22.3vw;
    left: 66.1vw;
}
#mainDockLargeShedC
{
    top: 23.2vw;
    left: 68.2vw;
}
#mainDockWestShedA
{
    top: 27.8vw;
    left: 63.9vw;
}
#mainDockWestShedB
{
    top: 27.8vw;
    left: 61.8vw;
}

/* COMPUND SECONDARY LOOT SPOTS */
#northA
{
    top: 28.4vw;
    left: 45.1vw;
}
#northB
{
    top: 30.7vw;
    left: 45.1vw;
}
#centralA
{
    top: 20.5vw;
    left: 32.3vw;
}
#centralB
{
    top: 22.7vw;
    left: 32.3vw;
}
#southA
{
    top: 34vw;
    left: 24.2vw;
}
#southB
{
    top: 34vw;
    left: 22vw;
}
#basementA
{
    top: 22.5vw;
    left: 22vw;
}
#basementB
{
    top: 22.5vw;
    left: 19.8vw;
}
/* SECONDARY LOOT MARKERS */
.lootOn  {}
.contentCash:before
{
    content: "$";
}
.contentCoke:before
{
    content: "C";
}
.contentGold:before
{
    content: "G";
}
.contentWeed:before
{
    content: "W";
}
.paintingOn:before
{
    content: "P";
}
.paintingSpot
{
    border: 0.2vw solid #8c3d40;
    width: 1.5vw;
    height: 1.8vw;
    display: block;
    position: absolute;
    font-size: 1.2vw;
    line-height: 2vw;
    color: transparent;
    text-shadow: 0 0 0.1vw #8c3d40;
    text-align: center;
    background-color: #1a1414de;
    cursor: url(img/cursor.png) 10 2,pointer;
    user-select: none;
}
/* COMPOUND PAITING SPOTS */
#paintingNorth
{
    top: 29.6vw;
    left: 42.7vw;
}
#paintingCentral
{
    top: 21.5vw;
    left: 30.1vw;
}
#paintingSouth
{
    top: 36.1vw;
    left: 23.1vw;
}
#paintingOfficeA
{
    top: 23.6vw;
    left: 26.1vw;
}
#paintingOfficeB
{
    top: 25vw;
    left: 23.9vw;
}
#paintingBasementA
{
    top: 20vw;
    left: 22vw;
}
#paintingBasementB
{
    top: 20vw;
    left: 19.8vw;
}
/* GTA STYLE MAP TOGGLE BUTTON */
#mapButton
{
    background-image: url(img/map_button.png);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
    top: 48.9vw;
    left: 62.2vw;
    width: 5.4vw;
    height: 2.1vw;
    cursor: url(img/cursor.png) 10 2,pointer;
    z-index: 1;
}

/* LOOT SELECTOR "CONTEXT" MENU */
.secondaryLootSelector
{
    position: absolute;
    top: 10vw;
    left: 10vw;
    width: 10vw;
    z-index: 4;
}
.secondaryLootSelector
{
    position: absolute;
    top: 10vw;
    left: 10vw;
    width: 10vw;
    z-index: 4;
}
.lootOption
{
    background-color: #1d1415;
    cursor: url(img/cursor.png) 10 2,pointer;
    border: 0.3vw solid #832929;
    user-select: none;
}
.lootOption span
{
    position: relative;
    top: -0.3vw;
    padding-left: 2vw;
    height: 2vw;
    font-size: 1.5vw;
    line-height: 2.5vw;
    color: transparent;
    text-shadow: 0 0 0.1vw #ffffffab;
    font-variant: all-small-caps;
    font-family: system-ui;
    pointer-events: none;
}
.lootOption::before
{
    border-radius: 50%;
    position: relative;
    left: 0.7vw;
    top: 0.3vw;
    border: 0.3vw solid #832929;
    content: "";
    display: inline-block;
    height: 1.5vw;
    width: 1.5vw;
}
.lootOption:hover
{
    background-color: #ffffffab;
    text-shadow: 0 0 0.1vw #000;
    transition: background-color 0.5s linear;
}
.lootOptionSeparator
{
    border: 1px dotted #832929;
    margin: 0.5vw 0vw 0.5vw 0vw;
}
.cashOption::before
{
    background-color: #525b54;
}
.cokeOption::before
{
    background-color: white;
}
.goldOption::before
{
    background-color: gold;
}
.weedOption::before
{
    background-color: green;
}
.emptyOption::before
{
    background-color: transparent;
}
#defaultLootPlacement
{
    position: absolute;
    right: 9.1vw;
    top: 43.5vw;
    width: 17vw;
    display: inline-block;
    color: transparent;
    padding-left: 1.8vw;
    font-size: 1.4vw;
    line-height: 2vw;
    font-variant: all-small-caps;
    font-family: system-ui;
    text-align: center;
    padding: 0 1vw 0.25vw 1vw;
    border: 0.3vw solid #8e3232;
    border-radius: 0.2vw;
    cursor: url(img/cursor.png) 10 2,pointer;
    user-select: none;
}
.usingCustomPrices
{
    text-shadow: 0 0 0.1vw #e45958ab;
    background-color: #1e1516c2;
}
.usingOriginalPrices
{
    text-shadow: 0 0 0.1vw #d05757;
    background-color: #451b1c;
}
/* INVISIBLE OVERLAY TO CLOSE CONTEXT MENU WHEN CLICKING ANYWHERE ELSE */
.secondarySelectorOverlay
{
    width: 100vw;
    height: 100vh;
    position: absolute;
    z-index: 3;
    user-select: none;
}

/* TUTORIAL OVERLAY STYLES */
#overlay
{
    width: 100vw;
    height: 100vh;
    position: absolute;
    z-index: 3;
    background-color: #00000077;
    transition: opacity 0.5s linear;
    user-select: none;
}
#overlay div
{
    padding: 0.5vw 1vw 0.5vw 1vw
}
#overlayClickZone
{
    width: 100vw;
    height: 100vh;
    position: absolute;
    cursor: url(img/cursor.png) 10 2,pointer;
}
.arrowLeft:before
{
    border-color: #ff9800b0 #ff9800b0 #ff9800b0 transparent;
    position: absolute;
    left: -3vw;
    top: 0.3vw;
    content: "";
    border-style: solid;
    border-width: 0 0 1.5vw 2.5vw;
}
.arrowLeft:after
{
    border-color: #ff9800b0 #ff9800b0 #ff9800b0 transparent;
    position: absolute;
    left: -3vw;
    top: 1.8vw;
    content: "";
    border-style: solid;
    border-width: 1.5vw 0 0 2.5vw;
}
.arrowRight:before
{
    border-color: transparent transparent transparent #ff9800b0;
    position: absolute;
    right: -3vw;
    top: 0.3vw;
    content: "";
    border-style: solid;
    border-width: 1.5vw 0 0 2.5vw;
}
.arrowRight:after
{
    border-color: transparent transparent transparent #ff9800b0;
    position: absolute;
    right: -3vw;
    top: 1.8vw;
    content: "";
    border-style: solid;
    border-width: 0 0 1.5vw 2.5vw;
}
.selectPrimary
{
    top: 35vw;
    left: 37vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.selectDifficulty
{
    top: 47.1vw;
    right: 32vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.calculatorAssumption
{
    top: 40.1vw;
    right: 42vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.moneyDisplay
{
    top: 40.9vw;
    left: 62vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.selectTruckLocation
{
    top: 25.7vw;
    left: 70.9vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.enterTakeLimit
{
    top: 19.3vw;
    right: 26.1vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.enterScoreLimit
{
    top: 13.1vw;
    right: 26.1vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.selectSafe
{
    top: 16.5vw;
    right: 13vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.primaryDisplay
{
    top: 6.5vw;
    right: 26.1vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.setHeistOptions
{
    top: 7.2vw;
    left: 37.1vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.calculateCuts
{
    top: 19.3vw;
    left: 37.1vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.selectLoot
{
    top: 29vw;
    left: 44.2vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.zoomInOut
{
    top: 26vw;
    left: 7.2vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.statTextOperations
{
    top: 3.7vw;
    left: 77.5vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}
.proTip
{
    top: 1.5vw;
    left: 1.5vw;
    position: absolute;
    border-radius: 2vw;
    background-color: #ff9800b0;
    font-size: 1.7vw;
}

.back
{
    position: absolute;
    background-image: url("img/button_back.png");
    background-size: contain;
    width: 4vw;
    height: 4vw;
    top: 28.2vw;
    left: 4.4vw;
    cursor: pointer;
    pointer-events: all;
    transition: filter 0.2s ease-in-out;
}
.back:hover
{
    filter: brightness(150%);
}

</style>
</head>
<body>
    <!-- TUTORIAL OVERLAY -->
    <div id="overlay">
        <div class="statTextOperations arrowLeft">Export your stat.txt and place it next to gtahaxui.exe.</div>
        <div class="setHeistOptions arrowLeft">Set your options here.</div>
        <div class="proTip">Pro tips:</br> - Be sure to pay setup fee in your submarine.</br> - When bugged, call Pavel to cancel the heist.</div>
        <div class="primaryDisplay arrowRight">Your primary loot price.</div>
        <div class="enterScoreLimit arrowRight">Game limits how much heist can give in total.</div>
        <div class="selectSafe arrowRight">Include El Rubio's safe by default. Disable if you skip office safe.</div>
        <div class="calculateCuts arrowLeft">Calculator needs player </br>cuts to maximize values.</div>
        <div class="zoomInOut">Use +/- or Shift+Mouse Wheel to zoom in or out.</div>
        <div class="enterTakeLimit arrowRight">Player cut has limit too.</br>Also this is how much</br>highest % cut player will</br> get.</div>
        <div class="selectTruckLocation arrowLeft">Click any truck icon to select its location.</div>
        <div class="selectLoot">Use Island and Compound maps</br>to select secondary loot spots.</div>
        <div class="selectPrimary arrowLeft">Click to open loot selector, click to select primary loot.</div>
        <div class="calculatorAssumption">Calculator assumes every player</br>will 100% fill their bag with loot.</div>
        <div class="moneyDisplay arrowLeft">Your calculated heist take will be displayed here.</div>
        <div class="selectDifficulty arrowRight">Toggle Normal or Hard Mode with this button.</div>
        <div id="overlayClickZone"></div>
    </div>

    <!-- PAGE BACKGROUND -->
    <div id="main"></div>

    <!-- SETUP -->
    <div id="setupContainer">
        <div id="setupCategories">
            <div id="approachVehiclesCategory" class="setupCategory"><div class="checkbox"></div><span>Approach Vehicles</span></div>
            <div id="weaponCategory" class="setupCategory"><div class="checkbox"></div><span>Weapons</span></div>
            <div id="disruptionCategory" class="setupCategory"><div class="checkbox"></div><span>Disruption</span></div>
            <div id="equipmentCategory" class="setupCategory"><div class="checkbox"></div><span>Equipment</span></div>
            <!-- <div id="islandLootCategory" class="setupCategory"><div class="checkbox"></div><span>Island Loot</span></div>
            <div id="compoundLootCategory" class="setupCategory"><div class="checkbox"></div><span>Compound Loot</span></div> -->
            <div id="takeCategory" class="setupCategory"><div class="checkbox"></div><span>Player Take Calculator</span></div>
        </div>
        <div id="approachVehiclesContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Approach Vehicles</div>
            <div id="vehicleKosatka" class="setupCategory" bit="1"><div class="checkbox"></div><span>Submarine: Kosatka</span></div>
            <div id="vehicleAlkonost" class="setupCategory" bit="2"><div class="checkbox"></div><span>Plane: Alkonost</span></div>
            <div id="vehicleVelum" class="setupCategory" bit="3"><div class="checkbox"></div><span>Plane: Velum</span></div>
            <div id="vehicleAnnihilator" class="setupCategory" bit="4"><div class="checkbox"></div><span>Helicopter: Stealth Annihilator</span></div>
            <div id="vehiclePatrolBoat" class="setupCategory" bit="5"><div class="checkbox"></div><span>Boat: Patrol Boat</span></div>
            <div id="vehicleLongfin" class="setupCategory" bit="6"><div class="checkbox"></div><span>Boat: Longfin</span></div>
        </div>
        <div id="weaponContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Weapons</div>
            <div id="weaponAggressor" class="setupCategory" int="1"><div class="checkbox"></div><span>Aggressor</span></div>
            <div id="weaponConspirator" class="setupCategory" int="2"><div class="checkbox"></div><span>Conspirator</span></div>
            <div id="weaponCrackshot" class="setupCategory" int="3"><div class="checkbox"></div><span>Crackshot</span></div>
            <div id="weaponSaboteur" class="setupCategory" int="4"><div class="checkbox"></div><span>Saboteur</span></div>
            <div id="weaponMarksman" class="setupCategory" int="5"><div class="checkbox"></div><span>Marksman</span></div>
            <div id="weaponSuppressors" class="setupCategory" bit="12"><div class="checkbox"></div><span>Suppressors</span></div>
        </div>
        <div id="disruptionContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Disruption</div>
            <div id="disruptionWeapons" class="setupCategory" bit="13"><div class="checkbox"></div><span>Weapons</span></div>
            <div id="disruptionArmor" class="setupCategory" bit="14"><div class="checkbox"></div><span>Armor</span></div>
            <div id="disruptionAirSupport" class="setupCategory" bit="15"><div class="checkbox"></div><span>Air Support</span></div>
            <div id="disruptionPoison" class="setupCategory" bit="13"><div class="checkbox"></div><span>Cutting Powder</span></div>
        </div>
        <div id="equipmentContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Equipment</div>
            <div id="equipmentDemoCharges" class="setupCategory" bit="8"><div class="checkbox"></div><span>Demolition Charges</span></div>
            <!-- <div id="equipmentTorch" class="setupCategory" bit="9"><div class="checkbox"></div><span>Cutting Torch</span></div> -->
        </div>
        <!-- <div id="islandLootContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Island Loot</div>
            <div id="islandLootCash" class="setupCategory"><div class="checkbox"></div><span>Cash</span></div>
            <div id="islandLootCoke" class="setupCategory"><div class="checkbox"></div><span>Coke</span></div>
            <div id="islandLootGold" class="setupCategory"><div class="checkbox"></div><span>Gold</span></div>
            <div id="islandLootWeed" class="setupCategory"><div class="checkbox"></div><span>Weed</span></div>
        </div>
        <div id="compoundLootContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Compund Loot</div>
            <div id="compoundLootCash" class="setupCategory"><div class="checkbox"></div><span>Cash</span></div>
            <div id="compoundLootCoke" class="setupCategory"><div class="checkbox"></div><span>Coke</span></div>
            <div id="compoundLootGold" class="setupCategory"><div class="checkbox"></div><span>Gold</span></div>
            <div id="compoundLootPainting" class="setupCategory"><div class="checkbox"></div><span>Painting</span></div>
            <div id="compoundLootWeed" class="setupCategory"><div class="checkbox"></div><span>Weed</span></div>
        </div> -->
        <div id="takeContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Player Take Calculator</div>
            <div id="teamsize" class="setupCategory"><span>Team Size</span><input class="teamSize" type="number" value="1" min="1" max="4"></div>
            <div id="playerHost" class="setupCategory playerTake"><span>Host</span><input class="playerCut" playerid="1" type="number" value="100" min="15" max="100" step="5"></div>
            <div id="player2" class="setupCategory playerTake hidden"><span>Player 2</span><input class="playerCut" playerid="2" type="number" value="15" min="15" max="100" step="5"></div>
            <div id="player3" class="setupCategory playerTake hidden"><span>Player 3</span><input class="playerCut" playerid="3" type="number" value="15" min="15" max="100" step="5"></div>
            <div id="player4" class="setupCategory playerTake hidden"><span>Player 4</span><input class="playerCut" playerid="4" type="number" value="15" min="15" max="100" step="5"></div>
        </div>
    </div>

    <!-- PRIMARY LOOT SELECTOR -->
    <div id="lootFrame">
        <div id="lootSelector" class="hidden">
            <div class="lootObject lootDefault" title="Game's Pick"></div>
            <div class="lootObject lootTequilla" title="Sinsimito Tequilla"></div>
            <div class="lootObject lootNecklace" title="Ruby Necklace"></div>
            <div class="lootObject lootBonds" title="Bearer Bonds"></div>
            <div class="lootObject lootDiamond" title="Pink Diamond"></div>
            <div class="lootObject lootPanther" title="Panther Statue"></div>
            <div class="lootObject lootFiles" title="Minimadrazzo Files"></div>
        </div>
    </div>

    <!-- PRIMARY LOOT SELECTED -->
    <div id="lootPic"></div>
    <div id="lootName"></div>

    <!-- DISPLAY TRUCK ICONS -->
    <div id="mainSettings">
        <!-- PRIMARY LOOT PRICE AND NAME -->
        <div id="moneyLimits">
            <div id="primaryName"></div>
            <input id="primaryValue" type="text" class="moneyLimit">

            <!-- TOTAL TAKE LIMIT -->
            <div id="takeLimitLabel" class="moneyLimitLabel">Total Take Limit</div>
            <input id="takeLimit" type="text" class="moneyLimit">

            <!-- CUT LIMIT -->
            <div id="cutLimitLabel" class="moneyLimitLabel">Cut Limit</div>
            <input id="cutLimit" type="text" class="moneyLimit">

            <!-- el rubio safe -->
            <div id="elRubioSafe" title="Want to take El Rubio's office safe?">☑</div>
        </div>


        <!-- ON SITE EQUIPMENT -->
        <div id="truck1" class="truckIcon"></div>
        <div id="truck2" class="truckIcon"></div>
        <div id="truck3" class="truckIcon"></div>
        <div id="truck4" class="truckIcon"></div>
        <div id="truck5" class="truckIcon"></div>

        <div id="hook1" class="hookIcon" bit="0"></div>
        <div id="hook2" class="hookIcon" bit="1"></div>
        <div id="hook3" class="hookIcon" bit="2"></div>
        <div id="hook4" class="hookIcon" bit="3"></div>

        <div id="clothes1" class="clothesIcon" bit="4"></div>
        <div id="clothes2" class="clothesIcon" bit="5"></div>
        <div id="clothes3" class="clothesIcon" bit="6"></div>
        <div id="clothes4" class="clothesIcon" bit="7"></div>

        <div id="cutters1" class="cuttersIcon" bit="8"></div>
        <div id="cutters2" class="cuttersIcon" bit="9"></div>
        <div id="cutters3" class="cuttersIcon" bit="10"></div>
        <div id="cutters4" class="cuttersIcon" bit="11"></div>

        <!-- SECONDARY LOOT SPOTS  -->
        <!--  AIRSTRIP -->
        <div id="hangarTopA" class="lootSpot" bit="0"></div>
        <div id="hangarTopB" class="lootSpot" bit="1"></div>
        <div id="hangarLowA" class="lootSpot" bit="2"></div>
        <div id="hangarLowB" class="lootSpot" bit="3"></div>
        <div id="airstripA" class="lootSpot" bit="4"></div>
        <div id="airstripB" class="lootSpot" bit="5"></div>

        <!-- NORTH DOCK -->
        <div id="northDockLongShedA" class="lootSpot" bit="6"></div>
        <div id="northDockLongShedB" class="lootSpot" bit="7"></div>

        <div id="northDockLockedShedA" class="lootSpot" bit="8"></div>
        <div id="northDockLockedShedB" class="lootSpot" bit="9"></div>
        <div id="northDockLockedShedC" class="lootSpot" bit="10"></div>

        <div id="northDockShedA" class="lootSpot" bit="11"></div>
        <div id="northDockShedB" class="lootSpot" bit="12"></div>

        <!-- WEED FARM -->
        <div id="weedFarmA" class="lootSpot" bit="13"></div>
        <div id="weedFarmB" class="lootSpot" bit="14"></div>

        <!-- CENTRAL SHED -->
        <div id="centralShedA" class="lootSpot" bit="15"></div>
        <div id="centralShedB" class="lootSpot" bit="16"></div>

        <!-- MAIN DOCK SHEDS -->
        <div id="mainDockEastShedA" class="lootSpot" bit="17"></div>
        <div id="mainDockEastShedB" class="lootSpot" bit="18"></div>

        <div id="mainDockLargeShedA" class="lootSpot" bit="19"></div>
        <div id="mainDockLargeShedB" class="lootSpot" bit="20"></div>
        <div id="mainDockLargeShedC" class="lootSpot" bit="21"></div>

        <div id="mainDockWestShedA" class="lootSpot" bit="22"></div>
        <div id="mainDockWestShedB" class="lootSpot" bit="23"></div>

        <!-- DISPLAY PLAYER CUT CALCULATOR -->
        <div id="playerCutContainer">
            <div class="playerMoney"><span></span><span></span></div>
            <div class="playerMoney"><span></span><span></span></div>
            <div class="playerMoney"><span></span><span></span></div>
            <div class="playerMoney"><span></span><span></span></div>
            <span id="totalCut"></span>
        </div>
    </div>

    <div id="mapButton"></div>

    <div id="compoundSettings" class="compoundContracted">
        <div id="compoundMap"></div>
        <div id="northA" class="lootSpot" bit="0"></div>
        <div id="northB" class="lootSpot" bit="1"></div>
        <div id="centralA" class="lootSpot" bit="2"></div>
        <div id="centralB" class="lootSpot" bit="3"></div>
        <div id="southA" class="lootSpot" bit="4"></div>
        <div id="southB" class="lootSpot" bit="5"></div>
        <div id="basementA" class="lootSpot" bit="6"></div>
        <div id="basementB" class="lootSpot" bit="7"></div>

        <div id="paintingNorth" class="paintingSpot" bit="0"></div>
        <div id="paintingCentral" class="paintingSpot" bit="1"></div>
        <div id="paintingSouth" class="paintingSpot" bit="2"></div>
        <div id="paintingOfficeA" class="paintingSpot" bit="3"></div>
        <div id="paintingOfficeB" class="paintingSpot" bit="4"></div>
        <div id="paintingBasementA" class="paintingSpot" bit="5"></div>
        <div id="paintingBasementB" class="paintingSpot" bit="6"></div>
    </div>

    <!-- secondary loot selector -->
    <div id="compoundSecondaryLootSelector" class="secondaryLootSelector hidden">
        <div class="lootOption emptyOption"><span>Empty</span></div>
        <div class="lootOptionSeparator"></div>
        <div class="lootOption goldOption"><span>Gold</span></div>
        <div class="lootOptionSeparator"></div>
        <div class="lootOption cashOption"><span>Cash</span></div>
        <div class="lootOption weedOption"><span>Weed</span></div>
        <div class="lootOption cokeOption"><span>Coke</span></div>
    </div>

    <div id="islandSecondaryLootSelector" class="secondaryLootSelector hidden">
        <div class="lootOption emptyOption"><span>Empty</span></div>
        <div class="lootOptionSeparator"></div>
        <div class="lootOption cashOption"><span>Cash</span></div>
        <div class="lootOption weedOption"><span>Weed</span></div>
        <div class="lootOption cokeOption"><span>Coke</span></div>
        <div class="lootOptionSeparator"></div>
        <div class="lootOption goldOption"><span>Gold</span></div>
    </div>

    <div id="compoundSelectorOverlay" class="secondarySelectorOverlay hidden"></div>
    <div id="islandSelectorOverlay" class="secondarySelectorOverlay hidden"></div>

    <!-- COPY AND DOWNLOAD BUTTONS -->
    <div id="stattextContainer">
        <div id="stattextLabel">stat.txt:</div>
        <div id="copyButton" class="statTextButton">copy to clipboard</div>
        <div id="downloadButton" class="statTextButton">download</div>
        <div id="displayButton" class="statTextButton">display</div>
    </div>

    <!-- DISABLE CUSTOM VALUES -->
    <div id="defaultLootPlacement" class="usingCustomPrices">Use Default Prices</div>

    <!-- HARD MODE INDICATOR -->
    <div id="hardModeButton" class="hardOff"></div>

    <!-- BACK BUTTON -->
    <a class="back" href="https://beholdmystuff.github.io/heist-stat.txt-maker/"></a>

    <!-- stat.txt display div -->
    <div class="statTextViewer hidden" contenteditable="true"></div>
    <div class="textViewOverlay hidden"></div>
</body>
<script>
/* CAYO PERICO HEIST SETUP DATA */
/* RESOURCES TO GENERATE STAT.TXT FROM */
let cayo =
{
    primary:
    [
        { name: "Minimadrazzo Files", price: 1100000, value: 4, className: "lootFiles" },
        { name: "Sinsimito Tequilla", price: 900000, value: 0, className: "lootTequilla" },
        { name: "Ruby Necklace", price: 1000000, value: 1, className: "lootNecklace" },
        { name: "Bearer Bonds", price: 1100000, value: 2, className: "lootBonds" },
        { name: "Pink Diamond", price: 1300000, value: 3, className: "lootDiamond" },
        { name: "Panther Statue", price: 1900000, value: 5, className: "lootPanther" }
    ],
    secondary:
    [
        { name: "Cash", size: 0.25, variable: "CASH" },
        { name: "Painting",  size: 0.5, variable: "PAINT"},
        { name: "Weed",  size: 0.4, variable: "WEED" },
        { name: "Coke",  size: 0.5, variable: "COKE" },
        { name: "Gold",  size: 0.6666666, variable: "GOLD" }
    ],
    npcCutPercentage: 12,
    hardModeMultiplier: 1.1,
    defaultCutLimit: 2550000,
    normalModeTakeLimit: 6662960,
    hardModeTakeLimit: 10818212,
    officeSafeMax: 120000
}

/* USER SET SETTINGS */
/* CREATE CURRENT STAT.TXT FROM THIS */
let settings =
{
    primary: 1, //cayo.primary.loot array id
    difficulty: "normal", //cayo.difficulty
    vehicleValue: 0,
    takeOfficeSafe: true,
    missionsBinary: 1+1024+2048+512, // gather intel + mandatory cutter + cloner + torch
    pois: 16384+65536, //power station + control tower
    compoundCash: 0,
    compoundCoke: 0,
    compoundGold: 0,
    compoundWeed: 0,
    compoundPainting: 0,
    islandCash: 0,
    islandCoke: 0,
    islandGold: 0,
    islandWeed: 0,
    defaultLootPrice: false
};

/* FUNCTIONALITY */

/* TOGGLES HARD MODE ON DIV CLICK */
function toggleHardMode(event)
{
    let button = event.target;

    /* recognize button state to decide what difficulty to write
       and which price to use */
    let primaryValue = document.querySelector("#primaryValue");
    if (button.className == "hardOff")
    {
        button.className = "hardOn";
        settings.difficulty = "hard";
        takeLimit.value = cayo.hardModeTakeLimit;
        formatTakeLimit(takeLimit);

        if (Number.isInteger(settings.primary.price))
            primaryValue.value = (settings.primary.price * cayo.hardModeMultiplier).toLocaleString()
    }
    else
    {
        button.className = "hardOff";
        settings.difficulty = "normal";
        takeLimit.value = cayo.normalModeTakeLimit;
        formatTakeLimit(takeLimit);

        if (Number.isInteger(settings.primary.price))
            primaryValue.value = (settings.primary.price).toLocaleString()
    }

    calculateTake();
}
document.querySelector("#hardModeButton").addEventListener("click", toggleHardMode); //hard mode button click event

function toggleDefaultMoney(event)
{
    let target = event.target;
    if (target.classList.contains("usingOriginalPrices"))
    {
        target.classList.remove("usingOriginalPrices");
        target.classList.add("usingCustomPrices");
        settings.defaultLootPrice = false;
        target.textContent = "Use Default Prices";

        // show custom price elements
        document.querySelector("#playerCutContainer").classList.remove("hidden");
        document.querySelector("#moneyLimits").classList.remove("hidden");
        document.querySelector("#takeCategory").classList.remove("hidden");

    }
    else
    {
        target.classList.remove("usingCustomPrices");
        target.classList.add("usingOriginalPrices");
        settings.defaultLootPrice = true;
        target.textContent = "Use Custom Prices";

        // remove custom price elements
        document.querySelector("#playerCutContainer").classList.add("hidden");
        document.querySelector("#moneyLimits").classList.add("hidden");
        document.querySelector("#takeCategory").classList.add("hidden");
    }
}
document.querySelector("#defaultLootPlacement").addEventListener("click", toggleDefaultMoney);

/* display loot selector */
function showLootSelector()
{
    document.querySelector("#lootSelector").classList.toggle("hidden");
}
document.querySelector("#lootFrame").addEventListener("click", showLootSelector); //loot selector button click event

/* select primary loot from selector */

function selectPrimaryLoot(lootName)
{
    let lootPic = document.querySelector("#lootPic");
    let lootNameElement = document.querySelector("#lootName");
    let primaryName = document.querySelector("#primaryName");
    let primaryValue = document.querySelector("#primaryValue");

    if (lootName == "Game's Pick")
    {
        settings.primary = "default";

        lootPic.className = "lootDefault";
        lootNameElement.textContent = "Game's Pick";
        primaryName.textContent = "Game's Pick";
        primaryValue.value = "Unknown";
    }
    else
    {
        /* find by name because lazy */
        cayo.primary.forEach(function(loot)
        {
            if (loot.name == lootName)
                settings.primary = loot;
        });

        /* set loot display */
        lootPic.className = settings.primary.className;
        lootNameElement.textContent = settings.primary.name;
        primaryName.textContent = settings.primary.name;
        primaryValue.value = (settings.difficulty == "normal") ? settings.primary.price.toLocaleString() : (settings.primary.price * cayo.hardModeMultiplier).toLocaleString();
    }

    calculateTake();
}
function selectPrimary(event)
{
    selectPrimaryLoot(event.target.title);
}
document.querySelectorAll(".lootObject").forEach(function(lootElement) //for each loot card add select function
{
    lootElement.addEventListener("click", selectPrimary);
});

// select tequilla by default
selectPrimaryLoot("Sinsimito Tequilla");

/* open category on click */
function expandSettingsContainer(event)
{
    document.querySelector("#setupCategories").className = "hidden";
    document.querySelector("#" + event.target.id.replace("Category", "Container")).classList.remove("hidden");
}
document.querySelectorAll("#setupCategories .setupCategory").forEach(function(setupCategory)
{
    setupCategory.addEventListener("click", expandSettingsContainer);
});

/* make escape key close, hide, cancel or go back */
function escapeKey(event)
{
    /* hide beautiful and helpful overlay */
    let overlay = document.querySelector("#overlay");
    if (!overlay.classList.contains("hidden"))
        closeOverlay(overlay); //passing element to closeElement function, I know, yuck

    /* hide stattext display */
    let textViewer = document.querySelector(".statTextViewer");
    if (!textViewer.classList.contains("hidden"))
        hideTextViewer(textViewer);

    /* hide loot selector */
    let lootSelector = document.querySelector("#lootSelector");
    if (lootSelector.className != "hidden")
        lootSelector.className = "hidden";

    /* go back with heist settings*/
    let setupCategories = document.querySelector("#setupCategories");
    if (setupCategories.className == "hidden")
    {
        //find setupcategory which is not hidden
        document.querySelectorAll(".setupCategoryContainer").forEach(function(category)
        {
            if (!category.classList.contains("hidden"))
            {
                //hide that shit and restore categories visibilty
                category.classList.add("hidden");
                setupCategories.classList.remove("hidden");
            }
        });
    }
}

/* TOGGLE COMPOUND MAP */
let togglingCompoundMap = false;
function spaceKey(event)
{
    if (togglingCompoundMap)
        return;

    var container = document.querySelector("#compoundSettings");

    if(document.querySelector("#overlay").classList.contains("hidden"))
    {
        togglingCompoundMap = true;
        if (container.classList.contains("compoundExpanded"))
        {
            container.classList.remove("compoundExpanded");
            container.classList.add("compoundHidden");
            setTimeout(function()
            {
                let container = document.querySelector("#compoundSettings")
                container.classList.remove("compoundHidden");
                container.classList.add("compoundContracted");
                setTimeout(function(){togglingCompoundMap = false;}, 500);
            }, 500);
        }
        else
        {
            container.classList.add("compoundExpanded");
            container.classList.remove("compoundContracted");
            setTimeout(function(){togglingCompoundMap = false;}, 1000);
        };
    }
}
document.querySelector("#mapButton").addEventListener("click", spaceKey);

function keyPressed(event)
{
    /* quit execution if non escape key is pressed */
    switch (event.keyCode)
    {
        case 27:
        escapeKey(event);
        break;

        case 32:
        spaceKey(event);
        break;

        case 189:
        keyZoom(-1);
        break;

        case 187:
        keyZoom(1);
        break;

        case 109:
        keyZoom(-1);
        break;

        case 107:
        keyZoom(1);
        break;
    }
}
document.addEventListener("keydown", keyPressed); //set da event

//wheel zoom
let scale = 1;
function zoom(factor)
{
    console.log(event);
    document.body.style.transform = "scale(" + factor + ")";
}

function wheelZoom(event)
{
    if (!event.shiftKey)
        return;

    scale += (event.deltaY * -0.001);
    zoom(scale);
}

function keyZoom(delta)
{
    scale += (delta * 0.01);
    zoom(scale);
}
document.addEventListener("wheel", wheelZoom); //set da event


/* back button function on click */
function goBack()
{
    document.querySelectorAll(".setupCategoryContainer").forEach(function(category)
    {
        if (!category.classList.contains("hidden"))
            category.classList.add("hidden");
    });

    document.querySelector("#setupCategories").classList.remove("hidden");
}
document.querySelectorAll(".backButton").forEach(function(button)
{
    button.addEventListener("click", goBack);
});

/* unlock vehicles */
function toggleVehicle(event)
{
    let bit = parseInt(event.target.getAttribute("bit"));

    var checkbox = event.target.querySelector(".checkbox");
    if (checkbox.classList.contains("checked"))
    {
        checkbox.classList.remove("checked");
        settings.missionsBinary -= 1 << bit; //remove the vehicle bit first

        // i did it single line but holy shit it was bad to read
        if (bit == 2 || bit == 4) //if alkonost or stealth annihilator are clicked on
        {
            if ((settings.missionsBinary & 1 << 2) == 0 // if alkonost
            && (settings.missionsBinary & 1 << 4) == 0) // and annihilator bits are no longer set
            {
                if ((settings.missionsBinary & 1 << 7) != 0) // but pilot bit is set
                    settings.missionsBinary -= 1 << 7;
            }
        }
    }
    else
    {
        checkbox.classList.add("checked");

        if (bit == 2 || bit == 4) // if alkonost or annihilator are clicked on
        {
            if ((settings.missionsBinary & 1 << 2) == 0 // if alkonost
            && (settings.missionsBinary & 1 << 4) == 0) // and annihilator
            {
                if ((settings.missionsBinary & 1 << 7) == 0) // and pilot are not set
                    settings.missionsBinary += 1 << 7; //set pilot bit and force kill all ifs
            }
        }

        settings.missionsBinary += 1 << bit; //then set vehicle bit
    }
}
document.querySelectorAll("#approachVehiclesContainer .setupCategory").forEach(function(vehicleElement)
{
    vehicleElement.addEventListener("click", toggleVehicle);
});

/* unlock equipment */
/* select weapon */
function selectWeapon(event)
{
    settings.weaponID = parseInt(event.target.getAttribute("int"));

    let checkbox = event.target.querySelector(".checkbox");
    if (checkbox.classList.contains("checked"))
    {
        event.target.querySelector(".checkbox").classList.remove("checked");
        settings.missionsBinary -= 1 << 12;
    }
    else
    {
        document.querySelectorAll("#weaponContainer .setupCategory:not(#weaponSuppressors)").forEach(function(weapon)
        {
            if (weapon.querySelector(".checkbox").classList.contains("checked"))
            {
                weapon.querySelector(".checkbox").classList.remove("checked");
                settings.missionsBinary -= 1 << 12; //either substract the bit or use additional if below. I chose math.
            }
        });

        event.target.querySelector(".checkbox").classList.add("checked");
        settings.missionsBinary += 1 << 12;
    }
}
document.querySelectorAll("#weaponContainer .setupCategory:not(#weaponSuppressors)").forEach(function(weapon)
{
    weapon.addEventListener("click", selectWeapon);
});

function selectSuppressors(event)
{
    let bit = parseInt(event.target.getAttribute("bit"));
    let checkbox = event.target.querySelector(".checkbox");
    if (checkbox.classList.contains("checked"))
    {
        checkbox.classList.remove("checked");
        settings.pois -= 1 << parseInt(event.target.getAttribute("bit"));
    }
    else
    {
        checkbox.classList.add("checked");
        settings.pois += 1 << parseInt(event.target.getAttribute("bit"));
    }
}
document.querySelector("#weaponSuppressors").addEventListener("click", selectSuppressors);

/* mark disruptions */
function markDisruption(event)
{
    let bit = event.target.getAttribute("bit");
    if (event.target.querySelector(".checkbox").classList.contains("checked"))
    {
        delete settings[event.target.id.replace("disruption", "").toLowerCase() + "Disruption"];
        event.target.querySelector(".checkbox").classList.remove("checked");

        if (event.target.id != "disruptionPoison") // disruptionPoison has different variable bit
            settings.missionsBinary -= 1 << parseInt(bit);
        else //diarrhea powder is in points of interest variable, yes
            settings.pois -= 1 << parseInt(bit);

    }
    else
    {
        settings[event.target.id.replace("disruption", "").toLowerCase() + "Disruption"] = 3;
        event.target.querySelector(".checkbox").classList.add("checked");

        if (event.target.id != "disruptionPoison")
            settings.missionsBinary += 1 << parseInt(bit);
        else
            settings.pois += 1 << parseInt(bit);
    }
    // console.log(event.target.id);
}
document.querySelectorAll("#disruptionContainer .setupCategory").forEach(function(disruption)
{
    disruption.addEventListener("click", markDisruption);
});

/* select equipment */
function markEquipment(event)
{
    let bit = event.target.getAttribute("bit");

    if (event.target.querySelector(".checkbox").classList.contains("checked"))
    {
        delete settings[event.target.id.replace("equipment", "").toLowerCase() + "Equipment"];
        event.target.querySelector(".checkbox").classList.remove("checked");

        if (bit)
            settings.missionsBinary -= 1 << parseInt(bit);
    }
    else
    {
        settings[event.target.id.replace("equipment", "").toLowerCase() + "Equipment"] = true;
        event.target.querySelector(".checkbox").classList.add("checked");

        if (bit)
            settings.missionsBinary += 1 << parseInt(bit);
    }
}
document.querySelectorAll("#equipmentContainer .setupCategory").forEach(function(equip)
{
    equip.addEventListener("click", markEquipment);
});

/* mark island loot */
function markIslandLoot(event)
{
    if (event.target.querySelector(".checkbox").classList.contains("checked"))
    {
        event.target.querySelector(".checkbox").classList.remove("checked");
        delete settings.islandLoot;
    }
    else
    {
        settings.islandLoot = event.target.id.replace("islandLoot", "").toLowerCase();
        document.querySelectorAll("#islandLootContainer .setupCategory").forEach(function(islandLoot)
        {
            islandLoot.querySelector(".checkbox").classList.remove("checked");
        });
        event.target.querySelector(".checkbox").classList.add("checked");
    }
}
document.querySelectorAll("#islandLootContainer .setupCategory").forEach(function(islandLoot)
{
    islandLoot.addEventListener("click", markIslandLoot);
});

/* mark compound loot */
function markCompoundLoot(event)
{
    if (event.target.querySelector(".checkbox").classList.contains("checked"))
    {
        event.target.querySelector(".checkbox").classList.remove("checked");

        if (event.target.id == "compoundLootPainting") //painting is a special case
            delete settings.painting;
        else
            delete settings.compoundLoot;
    }
    else
    {
        if (event.target.id != "compoundLootPainting") //painting is a special case
        {
            settings.compoundLoot = event.target.id.replace("compoundLoot", "").toLowerCase();
            document.querySelectorAll("#compoundLootContainer .setupCategory:not(#compoundLootPainting)").forEach(function(compoundLoot)
            {
                compoundLoot.querySelector(".checkbox").classList.remove("checked");
            });
        }
        else
        {
            settings.painting = true;
        }
        event.target.querySelector(".checkbox").classList.add("checked");
    }
}
document.querySelectorAll("#compoundLootContainer .setupCategory").forEach(function(compoundLoot)
{
    compoundLoot.addEventListener("click", markCompoundLoot);
});


/* GENERAL SECONDARY LOOT FUNCTIONS */
//convert pixel to vx
//to display secondary setter next to mouse cursor
function convertPXToVW(px)
{
    return px * (100 / document.documentElement.clientWidth);
}
function convertPXToVH(px)
{
    return px * (100 / document.documentElement.clientHeight);
}

/* WARNING: THERE WILL BE UGLY COPY/PASTE JOB */

/* ISLAND MAP SECONDARY LOOT */
//close secondary selector at various occasions
function closeIslandSecondarySelector()
{
    document.querySelector("#islandSelectorOverlay").classList.add("hidden");
    let selector = document.querySelector("#islandSecondaryLootSelector");
    selector.removeAttribute("bit");
    selector.classList.add("hidden");
}

/* clear secondary spot */
function clearIslandSecondary(location, bit)
{
    if (location.classList.contains("contentCash"))
        settings.islandCash -= 1 << bit;
    else if (location.classList.contains("contentCoke"))
        settings.islandCoke -= 1 << bit;
    else if (location.classList.contains("contentGold"))
        settings.islandGold -= 1 << bit;
    else if (location.classList.contains("contentWeed"))
        settings.islandWeed -= 1 << bit;

    location.className = "lootSpot";
}

//select compound secondary loot from selector
function selectIslandSecondary(event)
{
    let target = event.target;

    let selector = document.querySelector("#islandSecondaryLootSelector");
    let bit = parseInt(selector.getAttribute("bit"));
    let locationID = selector.getAttribute("location");
    let location = document.querySelector("#" + locationID);

    clearIslandSecondary(location, bit);

    let loot = target.querySelector("span").textContent.toLowerCase();

    if (loot == "cash")
    {
        settings.islandCash += 1 << bit;
        location.classList.add("contentCash");
    }
    else if (loot == "coke")
    {
        settings.islandCoke += 1 << bit;
        location.classList.add("contentCoke");
    }
    else if (loot == "gold")
    {
        settings.islandGold += 1 << bit;
        location.classList.add("contentGold");
    }
    else if (loot == "weed")
    {
        settings.islandWeed += 1 << bit;
        location.classList.add("contentWeed");
    }

    closeIslandSecondarySelector();
}
document.querySelectorAll("#islandSecondaryLootSelector .lootOption").forEach(function(option)
{
    option.addEventListener("click", selectIslandSecondary);
});

//compound secondary loot selector
function openIslandSecondarySelector(event)
{
    let target = event.target;

    let selector = document.querySelector("#islandSecondaryLootSelector");
    let top = (convertPXToVH(event.clientY) + 1);
    selector.style.top = top + "vh";
    selector.style.left = (convertPXToVW(event.clientX) + 1) + "vw";

    selector.classList.remove("hidden");
    let height = convertPXToVH(selector.offsetHeight);

    if ((100 - top) < height)
        selector.style.top = 100 - height + "vh";

    document.querySelector("#islandSelectorOverlay").classList.remove("hidden");

    let bit = target.getAttribute("bit");
    selector.setAttribute("bit", bit);

    let location = target.id;
    selector.setAttribute("location", location);
}
document.querySelectorAll("#mainSettings .lootSpot").forEach(function(lootSpot)
{
    lootSpot.addEventListener("click", openIslandSecondarySelector);
});
document.querySelector("#islandSelectorOverlay").addEventListener("click", closeIslandSecondarySelector);

/* COMPOUND MAP SECONDARY LOOT */
//close secondary selector at various occasions
function closeCompoundSecondarySelector()
{
    document.querySelector("#compoundSelectorOverlay").classList.add("hidden");
    let selector = document.querySelector("#compoundSecondaryLootSelector");
    selector.removeAttribute("bit");
    selector.classList.add("hidden");
}

/* clear secondary spot */
function clearCompoundSecondary(location, bit)
{
    if (location.classList.contains("contentCash"))
        settings.compoundCash -= 1 << bit;
    else if (location.classList.contains("contentCoke"))
        settings.compoundCoke -= 1 << bit;
    else if (location.classList.contains("contentGold"))
        settings.compoundGold -= 1 << bit;
    else if (location.classList.contains("contentWeed"))
        settings.compoundWeed -= 1 << bit;

    location.className = "lootSpot";
}

//select compound secondary loot from selector
function selectCompoundSecondary(event)
{
    let target = event.target;

    let selector = document.querySelector("#compoundSecondaryLootSelector");
    let bit = parseInt(selector.getAttribute("bit"));
    let locationID = selector.getAttribute("location");
    let location = document.querySelector("#" + locationID);

    clearCompoundSecondary(location, bit);

    let loot = target.querySelector("span").textContent.toLowerCase();

    if (loot == "cash")
    {
        settings.compoundCash += 1 << bit;
        location.classList.add("contentCash");
    }
    else if (loot == "coke")
    {
        settings.compoundCoke += 1 << bit;
        location.classList.add("contentCoke");
    }
    else if (loot == "gold")
    {
        settings.compoundGold += 1 << bit;
        location.classList.add("contentGold");
    }
    else if (loot == "weed")
    {
        settings.compoundWeed += 1 << bit;
        location.classList.add("contentWeed");
    }

    closeCompoundSecondarySelector();
}
document.querySelectorAll("#compoundSecondaryLootSelector .lootOption").forEach(function(option)
{
    option.addEventListener("click", selectCompoundSecondary);
});

//compound secondary loot selector
function openCompoundSecondarySelector(event)
{
    let target = event.target;

    let selector = document.querySelector("#compoundSecondaryLootSelector");
    let top = (convertPXToVH(event.clientY) + 1);
    selector.style.top = top + "vh";
    selector.style.left = (convertPXToVW(event.clientX) + 1) + "vw";

    selector.classList.remove("hidden");
    let height = convertPXToVH(selector.offsetHeight);

    if ((100 - top) < height)
        selector.style.top = 100 - height + "vh";
    document.querySelector("#compoundSelectorOverlay").classList.remove("hidden");

    let bit = target.getAttribute("bit");
    selector.setAttribute("bit", bit);

    let location = target.id;
    selector.setAttribute("location", location);
}
document.querySelectorAll("#compoundSettings .lootSpot").forEach(function(lootSpot)
{
    lootSpot.addEventListener("click", openCompoundSecondarySelector);
});

document.querySelector("#compoundSelectorOverlay").addEventListener("click", closeCompoundSecondarySelector);


/* SELECT PAINTING SPOTS */
function togglePaintingLocation(event)
{
    let target = event.target;
    let bit = parseInt(target.getAttribute("bit"));
    if (target.classList.contains("paintingOn"))
    {
        target.classList.remove("paintingOn");
        settings.compoundPainting -= 1 << bit;
    }
    else
    {
        target.classList.add("paintingOn");
        settings.compoundPainting += 1 << bit;
    }
}
document.querySelectorAll(".paintingSpot").forEach(function(spot)
{
    spot.addEventListener("click", togglePaintingLocation);
});

/* CALCULATE LOOT VALUES */

/* reverses percentage from current value and known percentage */
function reversePercentage(value, percent)
{
    if (percent == 100)
        return value;

    return (value * 100) / (100 - percent);
}
function reversePercentage2(value, percent)
{
    return (value / percent) * 100;
}

function getLootSize(loot)
{
    let size;
    cayo.secondary.forEach(function(type)
    {
        if (type.name.toLowerCase() == loot)
            size = type.size;
    });

    return size;
}
// different loot value for both normal and hard
function calculateCashValue(bagLoad)
{
    settings.cashValue = Math.floor(bagLoad * getLootSize("cash"));
}
function calculateCokeValue(bagLoad)
{
    settings.cokeValue = Math.floor(bagLoad * getLootSize("coke"));
}
function calculateGoldValue(bagLoad)
{
    settings.goldValue = Math.floor(bagLoad * getLootSize("gold"));
}
function calculatePaintingValue(bagLoad)
{
    settings.paintingValue = Math.floor(bagLoad * getLootSize("painting"));
}
function calculateWeedValue(bagLoad)
{
    settings.weedValue = Math.floor(bagLoad * getLootSize("weed"));
}


function calculateTopPlayerTake()
{
    //get top player take
    let topTakePlayerID = 0; //do i need this?
    let takeValue = 0;
    document.querySelectorAll("#takeContainer .setupCategory.playerTake:not(.hidden) input").forEach(function(input)
    {
        let percentageValue = parseInt(input.value);
        if (percentageValue > takeValue)
        {
            takeValue = percentageValue;
            topTakePlayerID = parseInt(input.getAttribute("playerid"));
        }
    });

    return takeValue;
}

function calculateTake()
{
    let topPlayerTake = calculateTopPlayerTake();

    //calculate full take based on highest percentage
    let fullTake = Math.floor(reversePercentage(settings.cutLimit, 100 - topPlayerTake));

    if (fullTake > settings.takeLimit)
        fullTake = settings.takeLimit;

    //add pavel cut for total money
    let score = Math.floor(reversePercentage(fullTake, cayo.npcCutPercentage));

    // calculate primary price if hard mode is on or minimadrazzo files are selected(no fencing fee)
    let primaryPrice = 0;
    if (settings.primary) //i did it with shorthand if at first but was very ugly and i didn't like to look at it
    {
        if (settings.difficulty == "hard")
            primaryPrice = Math.floor(settings.primary.price * cayo.hardModeMultiplier);
        else
            primaryPrice = settings.primary.price;

        if (settings.takeOfficeSafe)
            primaryPrice += cayo.officeSafeMax;

        // i assumed that minimadrazzo files == no fencing fee, but apparently it's not true
        // if (settings.primary.value == 4)
        //     score = Math.floor(reversePercentage(fullTake, 2));
    }

    // let primaryMinusPavel = Math.floor((primaryPrice * ((100 - cayo.npcCutPercentage) * 0.01)));
    let scoreMinusPrimary = Math.floor(score - primaryPrice);
    // let scoreMinusPrimary = Math.floor(reversePercentage(Math.floor(fullTake - primaryPrice), cayo.npcCutPercentage));

    let playerCount = parseInt(document.querySelector("#teamsize .teamSize").value);
    let singleBagLoad = scoreMinusPrimary / playerCount;

    //reduce by max office value
    // let safeMax = Math.ceil(reversePercentage((settings.takeOfficeSafe ? (cayo.officeSafeMax / playerCount) : 0), cayo.npcCutPercentage));
    // singleBagLoad -= safeMax;

    if (singleBagLoad) //might be undefined when no primary selected, we don't want 'undefined' in settings
    {
        if ((settings.compoundCash > 0 || settings.islandCash > 0) && !settings.defaultLootPrice)
            calculateCashValue(singleBagLoad);

        if ((settings.compoundCoke > 0 || settings.islandCoke > 0) && !settings.defaultLootPrice)
            calculateCokeValue(singleBagLoad);

        if ((settings.compoundGold > 0 || settings.islandGold > 0) && !settings.defaultLootPrice)
            calculateGoldValue(singleBagLoad);

        if (settings.compoundPainting > 0 && !settings.defaultLootPrice)
            calculatePaintingValue(singleBagLoad);

        if ((settings.compoundWeed > 0 || settings.islandWeed > 0) && !settings.defaultLootPrice)
            calculateWeedValue(singleBagLoad);
    }

    let playerMonies = document.querySelectorAll(".playerMoney");
    let takeContainers = document.querySelectorAll("#takeContainer .setupCategory.playerTake:not(.hidden)");
    let numContainers = takeContainers.length;

    for (var i = 0, l = 4; i < l; i++)
    {
        let playerMoni = playerMonies[i];
        let playerName = playerMoni.querySelector("span:first-child");
        let moniValue = playerMoni.querySelector("span:last-child");

        let takeContainer = takeContainers[i];

        if (i < numContainers)
        {
            let name = takeContainer.querySelector("span");
            let percentage = parseInt(takeContainer.querySelector("input").value);
            playerName.textContent = name.textContent;
            moniValue.textContent = formatNumber(Math.floor(fullTake * (percentage * 0.01)).toString()).string;
        }
        else
        {
            playerName.textContent = "";
            moniValue.textContent = "";
        }
    }

    document.querySelector("#totalCut").textContent = formatNumber(fullTake.toString()).string;

    // //don't want to need this anymore but i might
    // console.log("single bag load", singleBagLoad);
    // // console.log("rubios office safe max", safeMax);
    // console.log("max take", settings.cutLimit || cayo.defaultCutLimit);
    // console.log("top player take", topPlayerTake);
    // console.log("full take", fullTake);
    // console.log("score", score);
    // console.log("primary price", primaryPrice);
    // // console.log("primary minus pavel", primaryMinusPavel);
    // console.log("score minus primary", scoreMinusPrimary);
    // console.log("gold value", settings.goldValue);
    // console.log("painting value", settings.paintingValue);
}

/* set team size*/
function teamSizeChange(event)
{
    let playerTakeElements = document.querySelectorAll("#takeContainer .setupCategory.playerTake");
    let maxTeamSize = playerTakeElements.length;
    settings.teamSize = parseInt(event.target.value);

    for (var currentPlayer = 1; currentPlayer < maxTeamSize; currentPlayer++)
    {
        if (currentPlayer < settings.teamSize)
        {
            let currentPlayerElement = playerTakeElements[currentPlayer];
            currentPlayerElement.classList.remove("hidden");
            currentPlayerElement.querySelector(".playerCut").value = 15;
        }
        else
        {
            playerTakeElements[currentPlayer].classList.add("hidden");
        }
    }

    playerTakeElements[0].querySelector(".playerCut").value = 100 - ((settings.teamSize - 1) * 15);

    calculateTake();
}
document.querySelector("#teamsize input").addEventListener("input", teamSizeChange);

/* player take % */
function updatePlayerTake(event)
{
    let sum = 0;
    let sumOthers = 0;
    document.querySelectorAll("#takeContainer .setupCategory.playerTake:not(.hidden) input").forEach(function(input)
    {
        let value = parseInt(input.value);
        if (event.target != input)
            sumOthers += value;
        sum += value;
    });

    if (sum >= 100)
    {
        event.target.value = 100 - sumOthers;
    }

    calculateTake();
}
document.querySelectorAll("#takeContainer .setupCategory.playerTake input").forEach(function(input)
{
    input.addEventListener("input", updatePlayerTake);
});

function formatNumber(input)
{
    let number = input.replace(/[\D\s\._\-]+/g, "");
    number = number ? parseInt(number, 10) : 0;
    return {"string" : number.toLocaleString(), "int" : number};
}

/* team mate cut limit */
function formatCutLimit(element)
{
    let number = formatNumber(element.value);
    element.value = number.string;
    settings.cutLimit = number.int;
}
function updateCutLimit(event)
{
    formatCutLimit(event.target);
    calculateTake();
}
let cutLimit = document.querySelector("#cutLimit");
cutLimit.addEventListener("input", updateCutLimit);
cutLimit.value = cayo.defaultCutLimit;
formatCutLimit(cutLimit);

/* total take hard limit */
function formatTakeLimit(element)
{
    let number = formatNumber(element.value);
    element.value = number.string;
    settings.takeLimit = number.int;
}
function updateTakeLimit(event)
{
    formatTakeLimit(event.target);
    calculateTake();
}
let takeLimit = document.querySelector("#takeLimit");
takeLimit.addEventListener("input", updateTakeLimit);
takeLimit.value = cayo.normalModeTakeLimit;
formatTakeLimit(takeLimit);

/* beware of copy-paste monster*/
/* select supply truck location */
function selectSupplyTruckLocation(event)
{
    let target = event.target;

    settings.supplyTruckLocation = parseInt(target.id.replace("truck", ""));

    if (target.classList.contains("truckOn")) //disable truck selection
    {
        settings.pois -= 1 << 15;
        delete settings.supplyTruckLocation;
        target.classList.remove("truckOn");
    }
    else
    {
        let isTruckSelected = false;
        document.querySelectorAll(".truckIcon").forEach(function(truckElement)
        {
            if (truckElement.classList.contains("truckOn"))
                isTruckSelected = true;
            truckElement.classList.remove("truckOn");
        });

        //do not add bit if truck is already selected
        //cause you're just switching places of already enabled truck
        if (!isTruckSelected)
            settings.pois += 1 << 15;

        target.classList.add("truckOn");
    }
}
document.querySelectorAll(".truckIcon").forEach(function(truckElement)
{
    truckElement.addEventListener("click", selectSupplyTruckLocation);
});

//generic mark function
function markMyPOIsBoys(event, type)
{
    let target = event.target;
    let bit = parseInt(event.target.getAttribute("bit"));

    if (target.classList.contains(type + "On")) //disable truck selection
    {
        settings.pois -= 1 << bit;
        target.classList.remove(type + "On");
    }
    else
    {
        settings.pois += 1 << bit;
        target.classList.add(type + "On");
    }
}
//select grappling hook locations
function selectGrapplingHookLocation(event)
{
    markMyPOIsBoys(event, "hook");
}
document.querySelectorAll(".hookIcon").forEach(function(hookElement)
{
    hookElement.addEventListener("click", selectGrapplingHookLocation);
});
//select guard clothes locations
function selectGuardClothesLocation(event)
{
    markMyPOIsBoys(event, "clothes");
}
document.querySelectorAll(".clothesIcon").forEach(function(clothesElement)
{
    clothesElement.addEventListener("click", selectGuardClothesLocation);
});
//select bolt cutters location
function selectBoltCuttersLocation(event)
{
    markMyPOIsBoys(event, "cutters");
}
document.querySelectorAll(".cuttersIcon").forEach(function(cuttersElement)
{
    cuttersElement.addEventListener("click", selectBoltCuttersLocation);
});

/* edit primary value */
function formatPrimaryPrice(element)
{
    let number = formatNumber(element.value);
    element.value = number.string;
    if (settings.difficulty == "hard")
        settings.primary.price = Math.floor(number.int / cayo.hardModeMultiplier);
    else
        settings.primary.price = number.int;
}
function updatePrimaryPrive(event)
{
    formatPrimaryPrice(event.target);
    calculateTake();
}
document.querySelector("#primaryValue").addEventListener("input", updatePrimaryPrive);

function toggleOfficeSafe(event)
{
    let target = event.target;
    if (target.textContent == "☑")
    {
        target.textContent = "☐";
        delete settings.takeOfficeSafe;
    }
    else
    {
        target.textContent = "☑";
        settings.takeOfficeSafe = true;
    }
    calculateTake();
}
document.querySelector("#elRubioSafe").addEventListener("click", toggleOfficeSafe);

/* generate stat.txt string */
function generateStattext()
{
    var s = ["INT32"];

    /* $MPx_H4CNF_BS_GEN
    grappling hooks
    (bits are left shift value)
    int 1, bit 0 https://i.imgur.com/i9PpBqb.jpeg
    int 2, bit 1 https://i.imgur.com/XnTJNZ0.jpeg
    int 4, bit 2 https://i.imgur.com/mD1CnIH.jpg
    int 8, bit 3 https://i.imgur.com/DIRqJeO.jpeg

    guard clothes
    int 16, bit 4 https://i.imgur.com/TOToYmD.jpg
    int 32, bit 5 https://i.imgur.com/F5QICaa.jpg
    int 64, bit 6 https://i.imgur.com/o7ybn3e.jpeg
    int 128, bit 7 https://i.imgur.com/TnmehzB.jpeg

    bolt cutters
    int 256, bit 8 https://i.imgur.com/vp2dZ8h.jpg
    int 512, bit 9 https://i.imgur.com/uDVoRVY.jpg
    int 1024, bit 10 https://i.imgur.com/nRQUIAb.jpg
    int 2048, bit 11 https://i.imgur.com/quloOFA.jpg

    suppressors
    int 4096, bit 12

    cutting powder
    int 8192, bit 13

    power station
    int 16384, bit 14 https://i.imgur.com/BwTegxb.jpg

    supply truck
    int 32768, bit 15 https://i.imgur.com/vScO6P8.jpg

    control tower
    int 65536, bit 16 https://i.imgur.com/XZ6WiHV.jpg
    */

    s.push("$MPx_H4CNF_BS_GEN");
    s.push(settings.pois);

    // s.push("$MPx_H4CNF_BS_ENTR"); //TODO binary values for each entry point
    // s.push("63");

    // s.push("$MPx_H4CNF_BS_ABIL"); //TODO binary values for each support option
    // s.push("63");

    if (settings.weaponID)
    {
        s.push("$MPx_H4CNF_WEAPONS");
        s.push(settings.weaponID.toString());
    }

    if (settings.weaponsDisruption) //weapon disruption, full power (int 3)
    {
        s.push("$MPx_H4CNF_WEP_DISRP");
        s.push(settings.weaponsDisruption.toString());
    }

    if (settings.armorDisruption) //armor disruption
    {
        s.push("$MPx_H4CNF_ARM_DISRP");
        s.push(settings.armorDisruption.toString());
    }

    if (settings.airsupportDisruption) //air support disruption
    {
        s.push("$MPx_H4CNF_HEL_DISRP");
        s.push(settings.airsupportDisruption.toString());
    }

    if (settings.primary && settings.primary != "default") //primary loot
    {
        s.push("$MPx_H4CNF_TARGET");
        s.push(settings.primary.value.toString());
    }

    if ((settings.pois & 9) != 0 || (settings.pois & 10) != 0 || (settings.pois & 11) != 0 || (settings.pois & 12) != 0) //mark bolt cutter locations
    {
        s.push("$MPx_H4CNF_BOLTCUT");
        s.push("4424");
    }

    if ((settings.pois & 5) != 0 || (settings.pois & 6) != 0 || (settings.pois & 7) != 0 || (settings.pois & 8) != 0) //mark uniform locations
    {
        s.push("$MPx_H4CNF_UNIFORM");
        s.push("5256");
    }

    if ((settings.pois & 1) != 0 || (settings.pois & 2) != 0 || (settings.pois & 3) != 0 || (settings.pois & 4) != 0) //mark hook locations
    {
        s.push("$MPx_H4CNF_GRAPPEL");
        s.push("5156");
    }

    if (settings.supplyTruckLocation) //select truck location
    {
        s.push("$MPx_H4CNF_TROJAN");
        s.push(settings.supplyTruckLocation.toString());
    }

    //unlock all approaches i think
    // s.push("$MPx_H4CNF_APPROACH");
    // s.push("-1");

    /* COMPOUND BITS
    blank map https://i.imgur.com/IVqpjU3.jpg

    secondary loot
    int 1, bin 0, north a https://i.imgur.com/zANJYuc.jpg
    int 2, bin 1, north b https://i.imgur.com/hnKHMbi.jpeg
    int 4, bin 2, central a https://i.imgur.com/Q01PQfz.jpg
    int 8, bin 3, central b https://i.imgur.com/4nYIRQ3.jpg
    int 16, bin 4, south a https://i.imgur.com/p081Qi6.jpeg
    int 32, bin 5, south b https://i.imgur.com/B6l1wwj.jpg
    int 64, bin 6, basement a https://i.imgur.com/RqN3oUG.jpg
    int 128, bin 7, basement b https://i.imgur.com/dfzSX6o.jpg

    painting
    int 1, bin 0, north https://i.imgur.com/IIHw0t9.jpeg
    int 2, bin 1, central https://i.imgur.com/kxM1IX2.jpg
    int 3, bin 2, south https://i.imgur.com/eGCAnx6.jpg
    int 4, bin 3, office a https://i.imgur.com/8iYo4y5.jpg
    int 5, bin 4, office b https://i.imgur.com/UPMedAW.jpeg
    int 6, bin 5, basement a https://i.imgur.com/Lg06n2R.jpg
    int 7, bin 6, basement b https://i.imgur.com/Qdbk18Y.jpg
    */


    /* ISLAND BITS
    ref https://i.imgur.com/ccAahxj.jpg
    hangar
    int 1, bin 0, https://i.imgur.com/jPs2gQs.jpg
    int 2, bin 1, https://i.imgur.com/nKRx1lp.jpeg
    int 4, bin 2, https://i.imgur.com/e2qPz3q.jpeg
    int 8, bin 3, https://i.imgur.com/mFkJmLm.jpeg

    airstrip
    int 16, bin 4 https://i.imgur.com/iFkXVzB.jpeg
    int 32, bin 5, https://i.imgur.com/huQWq9L.jpeg

    north dock
    int 64, bin 6, https://i.imgur.com/JTWhO37.jpeg
    int 128, bin 7, https://i.imgur.com/gSgPWzL.jpg

    int 256, bin 8, https://i.imgur.com/jqzNjhY.jpg
    int 512, bin 9, https://i.imgur.com/HMKaDGd.jpeg
    int 1024, bin 10 https://i.imgur.com/i5aVuuR.jpg

    int 2048, bin 11 https://i.imgur.com/Wwadzhm.jpeg
    int 4096, bin 12 https://i.imgur.com/UkHrpkP.jpeg

    weed farm
    int 8192, bin 13 https://i.imgur.com/zgfeofw.jpg
    int 16384, bin 14 https://i.imgur.com/c3wgI6J.jpeg

    central shed
    int 32768, bin 15, https://i.imgur.com/RDTQruY.jpeg
    int 65536, bin 16, https://i.imgur.com/fX08CoH.jpeg

    main dock east shed
    int 131072, bin 17, https://i.imgur.com/jys5OaO.jpg
    int 262144, bin 18, https://i.imgur.com/uiIYmOS.jpg

    main dock large shed
    524288, bin 19, https://i.imgur.com/L8NW8QC.jpg
    1048576, bin 20, https://i.imgur.com/AoCoRQ0.jpeg
    2097152, bin 21, https://i.imgur.com/qGcwBvn.jpg

    main dock west shed
    4194304, bin 22, https://i.imgur.com/ivsNPQH.jpg
    8388608, bin 23, https://i.imgur.com/9sqxEql.jpg
    */

    /* SECONDARY LOOT LOCATIONS AND SCOPES */

    //CASH
    s.push("$MPx_H4LOOT_CASH_I");
    s.push(settings.islandCash.toString());
    s.push("$MPx_H4LOOT_CASH_I_SCOPED");
    s.push(settings.islandCash.toString());
    s.push("$MPx_H4LOOT_CASH_C");
    s.push(settings.compoundCash.toString());
    s.push("$MPx_H4LOOT_CASH_C_SCOPED");
    s.push(settings.compoundCash.toString());

    //COKE
    s.push("$MPx_H4LOOT_COKE_I");
    s.push(settings.islandCoke.toString());
    s.push("$MPx_H4LOOT_COKE_I_SCOPED");
    s.push(settings.islandCoke.toString());
    s.push("$MPx_H4LOOT_COKE_C");
    s.push(settings.compoundCoke.toString());
    s.push("$MPx_H4LOOT_COKE_C_SCOPED");
    s.push(settings.compoundCoke.toString());

    //GOLD
    s.push("$MPx_H4LOOT_GOLD_I");
    s.push(settings.islandGold.toString());
    s.push("$MPx_H4LOOT_GOLD_I_SCOPED");
    s.push(settings.islandGold.toString());
    s.push("$MPx_H4LOOT_GOLD_C");
    s.push(settings.compoundGold.toString());
    s.push("$MPx_H4LOOT_GOLD_C_SCOPED");
    s.push(settings.compoundGold.toString());

    //WEED
    s.push("$MPx_H4LOOT_WEED_I");
    s.push(settings.islandWeed.toString());
    s.push("$MPx_H4LOOT_WEED_I_SCOPED");
    s.push(settings.islandWeed.toString());
    s.push("$MPx_H4LOOT_WEED_C");
    s.push(settings.compoundWeed.toString());
    s.push("$MPx_H4LOOT_WEED_C_SCOPED");
    s.push(settings.compoundWeed.toString());

    //PAINTING
    s.push("$MPx_H4LOOT_PAINT");
    s.push(settings.compoundPainting.toString());
    s.push("$MPx_H4LOOT_PAINT_SCOPED");
    s.push(settings.compoundPainting.toString());

    //set cash value
    if (settings.defaultLootPrice == false)
    {

        if (settings.cashValue)
        {
            s.push("$MPx_H4LOOT_CASH_V");
            s.push(settings.cashValue.toString());
        }

        //set coke value
        if (settings.cokeValue)
        {
            s.push("$MPx_H4LOOT_COKE_V");
            s.push(settings.cokeValue.toString());
        }

        //set gold value
        if (settings.goldValue)
        {
            s.push("$MPx_H4LOOT_GOLD_V");
            s.push(settings.goldValue.toString());
        }

        //set painting value
        if (settings.paintingValue)
        {
            s.push("$MPx_H4LOOT_PAINT_V");
            s.push(settings.paintingValue.toString());
        }

        //set painting value
        if (settings.weedValue)
        {
            s.push("$MPx_H4LOOT_WEED_V");
            s.push(settings.weedValue.toString());
        }
    }

    //set difficulty
    s.push("$MPx_H4_PROGRESS");
    if (settings.difficulty == "hard")
        s.push("131055");
    else
        s.push("124271");

    //no idea what this does, can guess by the name though
    s.push("$MPx_H4_MISSIONS");
    s.push(settings.missionsBinary.toString());

    if (settings.missionsBinary > 65535)
        console.error("Mission Binary ridiculously high:", settings.missionsBinary)

    // s.push("$MPx_H4_PLAYTHROUGH_STATUS");
    // s.push("40000");

    return s.join("\n");
}

function downloadTxt()
{
    calculateTake();

    //create data blob
    var blob = new Blob([generateStattext()], {type: 'text/csv'});

    //download data blob
    if (window.navigator.msSaveOrOpenBlob) //with api
    {
        window.navigator.msSaveBlob(blob, "stat.txt");
    }
    else //without api
    {
        var element = window.document.createElement('a');
        element.href = window.URL.createObjectURL(blob);
        element.download = "stat.txt";
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
    }
}

function copyToClipboard()
{
    calculateTake();

    //create invisible textarea to copy
    var textArea = document.createElement("textarea");
    textArea.className = "invisibleTextarea";
    textArea.value = generateStattext();
    document.body.appendChild(textArea);

    //copy
    textArea.focus();
    textArea.select();
    document.execCommand('copy')

    //remove witness
    document.body.removeChild(textArea);
}
/* do something with stat.txt buttons */
function fadeDatShiet(element)
{
    element.classList.add("appear");
    element.classList.remove("fadeOut");
    setTimeout(function(element){element.classList.add("appear");}, 0, element);
    setTimeout(function(element)
    {
        element.classList.add("fadeOut");
        element.classList.remove("appear");
    }, 0, element);
}

function copyButton(event)
{
    copyToClipboard();
    let button = document.querySelector("#copyButton");
    fadeDatShiet(button);
}
document.querySelector("#copyButton").addEventListener("click", copyButton);

function downloadButton(event)
{
    downloadTxt();
    let button = document.querySelector("#downloadButton");
    fadeDatShiet(button);
}
document.querySelector("#downloadButton").addEventListener("click", downloadButton);

function hideTextViewer()
{
    document.querySelector(".statTextViewer").classList.add("hidden");
    document.querySelector(".textViewOverlay").classList.add("hidden");
}
document.querySelector(".textViewOverlay").addEventListener("click", hideTextViewer);

// handle display button
function displayButton(event)
{
    calculateTake();

    let viewerOverlay = document.querySelector(".textViewOverlay");
    let viewer = document.querySelector(".statTextViewer");
    viewer.textContent = generateStattext();

    viewerOverlay.classList.remove("hidden");
    viewer.classList.remove("hidden");
}
document.querySelector("#displayButton").addEventListener("click", displayButton);

/* close overlay on click */
function closeOverlay(element)
{
    element.style.opacity = "0";
    document.querySelector("#overlayClickZone").removeEventListener("click", closeOverlay);
    try
    {
        setTimeout(function() { element.classList.add("hidden") }, 500);
    } catch {}
}
function clickOverlay(event)
{
    closeOverlay(event.target.parentNode);
}
document.querySelector("#overlayClickZone").addEventListener("click", clickOverlay);
</script>
</html>
